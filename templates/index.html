<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AUDAA - Text to Speech Converter</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <nav class="navbar">
        <div class="logo">
            <i class="fas fa-headphones"></i>
            <span>AUDAA</span>
        </div>
    </nav>

    <div class="container">
        <div class="hero">
            <h1>Transform Text to Natural Speech</h1>
            <p>Professional text-to-speech conversion in multiple languages</p>
        </div>
        
        {% if error %}
        <div class="error">
            <i class="fas fa-exclamation-circle"></i>
            {{ error }}
        </div>
        {% endif %}

        <div class="card">
            <form method="POST" id="ttsForm">
                <div class="form-group">
                    <label for="text">
                        <i class="fas fa-pen"></i>
                        Text to convert:
                    </label>
                    <textarea name="text" id="text" required placeholder="Enter your text here..."></textarea>
                    <div class="char-count">0 characters</div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="language">
                            <i class="fas fa-globe"></i>
                            Language:
                        </label>
                        <select name="language" id="language">
                            <option value="en-us">English (US)</option>
                            <option value="fr-fr">French</option>
                            <option value="de">German</option>
                            <option value="ja">Japanese</option>
                            <option value="ko">Korean</option>
                            <option value="cmn">Mandarin Chinese</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="speaking_rate">
                            <i class="fas fa-tachometer-alt"></i>
                            Speaking Rate:
                        </label>
                        <div class="range-container">
                            <input type="range" name="speaking_rate" id="speaking_rate" 
                                min="5" max="35" value="15" required>
                            <span class="range-value">15</span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="format">
                            <i class="fas fa-file-audio"></i>
                            Format:
                        </label>
                        <select name="format" id="format">
                            <option value="mp3">MP3</option>
                            <option value="wav">WAV</option>
                            <option value="webm">WebM</option>
                            <option value="ogg">OGG</option>
                        </select>
                    </div>
                </div>

                <div class="button-group">
                    <button type="button" id="previewBtn" class="secondary">
                        <i class="fas fa-play"></i> Preview
                    </button>
                    <button type="submit">
                        <i class="fas fa-download"></i> Generate & Download
                    </button>
                </div>
            </form>

            <div id="previewPlayer" class="preview-player" style="display: none;">
                <audio id="audioPreview" controls></audio>
            </div>
        </div>
    </div>

    <footer>
        <p>Â© 2024 AUDAA - Professional Text-to-Speech Service</p>
    </footer>

    <script>
        // Character counter
        document.getElementById('text').addEventListener('input', function(e) {
            document.querySelector('.char-count').textContent = `${e.target.value.length} characters`;
        });

        // Range value display
        document.getElementById('speaking_rate').addEventListener('input', function(e) {
            document.querySelector('.range-value').textContent = e.target.value;
        });

        // Preview functionality
        document.getElementById('previewBtn').addEventListener('click', async function() {
            const text = document.getElementById('text').value;
            const language = document.getElementById('language').value;
            const speaking_rate = document.getElementById('speaking_rate').value;

            if (!text) {
                alert('Please enter some text first');
                return;
            }

            this.disabled = true;
            this.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating...';

            try {
                const response = await fetch('/api/preview', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ text, language, speaking_rate })
                });

                const data = await response.json();
                
                if (data.success) {
                    const audio = document.getElementById('audioPreview');
                    audio.src = `data:audio/mp3;base64,${data.audio}`;
                    document.getElementById('previewPlayer').style.display = 'block';
                    audio.play();
                } else {
                    alert('Preview generation failed: ' + data.error);
                }
            } catch (error) {
                alert('Error generating preview: ' + error);
            }

            this.disabled = false;
            this.innerHTML = '<i class="fas fa-play"></i> Preview';
        });
    </script>
</body>
</html> 